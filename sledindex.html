<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SoulFlame Parallax + 3D Cards</title>

<!-- Vue.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

<style>
/* -------------------------------------------------------
   ORIGINAL PARALLAX
------------------------------------------------------- */
:root {
  --scrub: #C0B3A0;
  --foregroundDuration: 30s;
  --hillsDuration: 60s;
  --rocks1Duration: 120s;
  --rocks2Duration: 240s;
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow-x: hidden;
}

section {
  position: relative;
  width: 100%;
  height: 100vh;
  background-color: var(--scrub);
}

.paralax {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: url("http://www.testomic.com/public/codepen-assets/img/paralax/background.jpg");
  background-size: cover;
  background-position: center;
}

.paralax .layer {
  position: absolute;
  width: 400%;
}

.paralax .foreground {
  height: 50%;
  bottom: 0;
  background: url("http://www.testomic.com/public/codepen-assets/img/paralax/foreground.png") repeat-x;
  background-size: 25% 100%;
  animation: slideshow var(--foregroundDuration) linear infinite;
}

.paralax .hills {
  height: 40%;
  bottom: 15%;
  background: url("http://www.testomic.com/public/codepen-assets/img/paralax/hills.png") repeat-x;
  background-size: 25% 100%;
  animation: slideshow var(--hillsDuration) linear infinite;
}

.paralax .rocks1 {
  height: 35%;
  bottom: 25%;
  background: url("http://www.testomic.com/public/codepen-assets/img/paralax/rocks1.png") repeat-x;
  background-size: 25% 100%;
  animation: slideshow var(--rocks1Duration) linear infinite;
}

.paralax .rocks2 {
  height: 40%;
  bottom: 15%;
  background: url("http://www.testomic.com/public/codepen-assets/img/paralax/rocks2.png") repeat-x;
  background-size: 25% 100%;
  animation: slideshow var(--rocks2Duration) linear infinite;
}

@keyframes slideshow {
  0%   { transform: translateX(0%); }
  100% { transform: translateX(-50%); }
}

/* -------------------------------------------------------
   CENTERED CARD GRID
------------------------------------------------------- */

.card-center-wrapper {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 1300px;
  z-index: 20; /* над паралакса */
}

.title {
  text-align: center;
  font-family: Raleway;
  font-size: 28px;
  font-weight: 700;
  color: white;
}

/* ORIGINAL CARD CSS */
.container {
  padding: 20px 20px;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

.card-wrap {
  margin: 10px;
  transform: perspective(800px);
  transform-style: preserve-3d;
  cursor: pointer;
}

.card {
  position: relative;
  width: 280px;
  height: 320px;
  background-color: #333;
  overflow: hidden;
  border-radius: 10px;
  box-shadow: rgba(0,0,0,0.66) 0 30px 60px 0,
              inset #333 0 0 0 5px,
              inset rgba(255,255,255,0.5) 0 0 0 6px;
  transition: 1s cubic-bezier(0.445, 0.05, 0.55, 0.95);
}

.card-bg {
  opacity: 0.5;
  position: absolute;
  top: -20px;
  left: -20px;
  width: 120%;
  height: 120%;
  background-size: 100% !important;
  background-position: center;
  pointer-events: none;
  transition: 1s;
}

.card-info {
  padding: 20px;
  position: absolute;
  bottom: 0;
  color: #fff;
  transform: translateY(40%);
  transition: 0.6s;
}

.card-info h1 {
  font-family: Playfair Display;
  font-size: 36px;
  font-weight: 700;
}

.card-info p {
  opacity: 0;
}

/* Hover Effects */
.card-wrap:hover .card-info { transform: translateY(0); }
.card-wrap:hover .card-info p { opacity: 1; }
.card-wrap:hover .card { box-shadow: rgba(255,255,255,0.2) 0 0 40px 5px; }
.card-wrap:hover .card-bg { opacity: 0.8; }

</style>
</head>

<body>

<section>
  <div class="paralax">
    <div class="layer rocks2"></div>
    <div class="layer rocks1"></div>
    <div class="layer hills"></div>
    <div class="layer foreground"></div>
  </div>

  <!-- ➜ 4D PARALLAX + CARDS IN THE CENTER -->
  <div class="card-center-wrapper">
    <h1 class="title">SoulFlame</h1>

    <div id="app" class="container">

      <card data-image="https://images.unsplash.com/photo-1479660656269-197ebb83b540?auto=compress&fit=crop&w=800&q=80">
        <h1 slot="header">TWINVERSE</h1>
        <p slot="content">Тук е твоят вътрешен свят – профил, характер и дигитална същност.</p>
      </card>

      <card data-image="https://images.unsplash.com/photo-1479659929431-4342107adfc1?auto=compress&fit=crop&w=800&q=80">
        <h1 slot="header">METAVERCE</h1>
        <p slot="content">AGI Twin се движи, общува и твори с теб и другите Twins.</p>
      </card>

      <card data-image="https://images.unsplash.com/photo-1479644025832-60dabb8be2a1?auto=compress&fit=crop&w=800&q=80">
        <h1 slot="header">NEUROVERSE</h1>
        <p slot="content">Социална вселена, реагираща на твоите емоции.</p>
      </card>

      <card data-image="https://images.unsplash.com/photo-1479621051492-5a6f9bd9e51a?auto=compress&fit=crop&w=800&q=80">
        <h1 slot="header">INNOVATIONS LAB</h1>
        <p slot="content">Проследяваш бъдещите технологии и участваш в създаването им.</p>
      </card>

    </div>
  </div>
</section>

<script>
Vue.component('card', {
  template: `
    <div class="card-wrap"
      @mousemove="handleMouseMove"
      @mouseenter="handleMouseEnter"
      @mouseleave="handleMouseLeave"
      @click="handleTap"
      ref="card">

      <div class="card" :style="cardStyle">
        <div class="card-bg" :style="[cardBgTransform, cardBgImage]"></div>
        <div class="card-info" :class="{ show: infoVisible }">
          <slot name="header"></slot>
          <slot name="content"></slot>
        </div>
      </div>
    </div>` ,

  props: ['dataImage'],

  data: () => ({
    width: 0,
    height: 0,
    mouseX: 0,
    mouseY: 0,
    resetTimer: null,

    isMobile: ('ontouchstart' in window), // засичаме телефон
    infoVisible: false, // показано описание
    tapCount: 0 // брои таповете
  }),

  mounted() {
    this.width = this.$refs.card.offsetWidth;
    this.height = this.$refs.card.offsetHeight;
  },

  computed: {
    mousePX() { return this.isMobile ? 0 : this.mouseX / this.width; },
    mousePY() { return this.isMobile ? 0 : this.mouseY / this.height; },

    cardStyle() {
      if (this.isMobile) return { transform: "rotateY(0deg) rotateX(0deg)" };

      const rX = this.mousePX * 30;
      const rY = this.mousePY * -30;
      return { transform: `rotateY(${rX}deg) rotateX(${rY}deg)` };
    },

    cardBgTransform() {
      if (this.isMobile) return { transform: "translateX(0px) translateY(0px)" };

      const tX = this.mousePX * -40;
      const tY = this.mousePY * -40;
      return { transform: `translateX(${tX}px) translateY(${tY}px)` };
    },

    cardBgImage() {
      return { backgroundImage: `url(${this.dataImage})` };
    }
  },

  methods: {

    /* ------------ MOBILE TAP LOGIC ------------- */
    handleTap() {
      if (!this.isMobile) return;

      this.tapCount++;

      // ПЪРВИ TAP → показва описанието
      if (this.tapCount === 1) {
        this.infoVisible = true;

        setTimeout(() => {
          this.tapCount = 1; // оставяме го да чака втори tap
        }, 300);
      }

      // ВТОРИ TAP → ОТВАРЯ ДРУГА СТРАНИЦА
      else if (this.tapCount === 2) {
        window.location.href = "page.html"; // ТУК СМЕНИ С ТВОЯ ЛИНК
      }
    },

    /* ------------ DESKTOP 3D LOGIC ------------- */
    startResetTimer() {
      if (this.isMobile) return;

      clearTimeout(this.resetTimer);

      this.resetTimer = setTimeout(() => {
        this.mouseX = 0;
        this.mouseY = 0;

        const cardEl = this.$refs.card.querySelector('.card');
        cardEl.style.transition = "transform 0.3s ease-out";
        cardEl.style.transform = "rotateY(0deg) rotateX(0deg)";

        setTimeout(() => {
          cardEl.style.transition = "";
          cardEl.style.transform = "";
        }, 350);

      }, 2000);
    },

    handleMouseMove(e) {
      if (this.isMobile) return;

      clearTimeout(this.resetTimer);

      this.mouseX = e.pageX - this.$refs.card.offsetLeft - this.width/2;
      this.mouseY = e.pageY - this.$refs.card.offsetTop - this.height/2;
    },

    handleMouseEnter() {
      if (this.isMobile) return;
      clearTimeout(this.resetTimer);
    },

    handleMouseLeave() {
      if (this.isMobile) return;
      this.startResetTimer();
    }
  }
});

new Vue({ el: '#app' });
</script>

</body>
</html>
